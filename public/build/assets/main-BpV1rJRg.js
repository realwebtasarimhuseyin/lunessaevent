import{u as f}from"./real-ZMtuIudR.js";import"./app-DeQrA2Ni.js";import"./axios-upsvKRUO.js";const{Swall:u,FiyatFormati:l}=f();document.addEventListener("DOMContentLoaded",function(){m(),v()});const c={urunler:[],sepeteEkle(r,e=1){let t=this.urunler.find(n=>JSON.stringify(n.varyantlar)===JSON.stringify(r.varyantlar)&&JSON.stringify(n.id)==JSON.stringify(r.id));t?t.adet=Number(t.adet)+Number(e):this.urunler.push({...r,adet:e}),this.sepetiKaydet()},sepettenCikar(r,e){const t=this;axios.post(`${appUrl}/sepet/sil`,{sepet_id:r}).then(function(n){u({icon:"success",tiklamaDurum:!1,baslik:n.data.mesaj}),t.sepetiYukle(),e(!0)}).catch(function(n){u({icon:"error",baslik:n.response?n.response.data.mesaj:"Bir hata oluştu.",onayButonİcerik:"Tamam"}),e(!1)})},sepetiTemizle(){const r=this;axios.post(`${appUrl}/sepet/tumsil`).then(function(e){r.sepetiYukle()}).catch(function(e){console.log(e)})},sepetiKaydet(){const r=this;return axios.post(`${appUrl}/sepet/duzenle`,{urunler:r.urunler}).then(function(e){return u({icon:"success",tiklamaDurum:!1,baslik:e.data.mesaj}),r.sepetiYukle(),!0}).catch(function(e){return u({icon:"error",baslik:e.response?e.response.data.mesaj:"Bir hata oluştu.",onayButonİcerik:"Tamam"}),r.sepetiYukle(),!1})},sepetiYukle(){const r=this;axios({method:"get",url:`${appUrl}/sepet/liste?dil=${aktifDil}`,responseType:"json"}).then(function(e){const t=e.data;var n=t.urunler;return r.urunler=[],Array.isArray(n)||(n=[n]),n.forEach(s=>{var a={id:s.urun_id,adet:s.adet,birim_fiyat:s.birim_fiyat,sepet_id:s.sepet_id,varyantlar:[]};s.varyantlar.forEach(o=>{a.varyantlar.push(o.urun_varyant_ozellik_id)}),r.urunler.push(a)}),r.sepetArayuzunuGuncelle(t,n)})},sepetArayuzunuGuncelle(r,e){r.sepet_toplam;const t=document.getElementById("sepet-onizleme-cnt");if(t&&t.querySelectorAll(".pr").forEach(o=>o.remove()),e.length>0)e.forEach((a,o)=>{if(t){const p=document.createElement("li");p.classList.add("pr"),p.setAttribute("sepet-id",a.sepet_id),p.innerHTML=`


                 <a href="#">
                    <img src="${a.ana_resim}" alt="">
                </a>
                <div>
                    <h6 class="mb-0"> ${a.urun_baslik}</h6>
                    <p>
                      ${Object.values(a.varyantlar).map(d=>`${d.ana_varyant_isim} : ${d.urun_varyant_ozellik_isim}<br/>`).join("")}
                    </p>
                    <p>
                        ${a.adet} X ${l(a.birim_fiyat)}
                    </p>
                    
                </div>
                <i class="iconsax delete-icon sepetten-cikar-btn" data-icon="trash"></i>
                                    `,t.prepend(p)}});else if(t){const a=document.createElement("li");a.classList.add("mt-1","pr","text-center","d-block"),aktifDil=="tr"?a.innerHTML="Sepetinizde ürün yok !":a.innerHTML="There are no items in your cart !",t.prepend(a)}if(t&&$("#sepet-onizleme-tutar").html(l(r.sepet_toplam)),r.kupon_tutar>0){var n=$("#indirimTutarCnt");n.removeClass("d-none"),n.find("#sepetIndirimTutar").html(l(r.kupon_tutar));var s=$("#kuponOnayCnt");s.removeClass("d-none"),s.find("#seciliKuponKodu").html(r.kupon_bilgi.kod),r.kupon_bilgi.yuzde>0?s.find("#kuponIndirimMiktar").html(r.kupon_bilgi.yuzde+"% indirim"):r.kupon_bilgi.tutar>0&&s.find("#kuponIndirimMiktar").html(r.kupon_bilgi.tutar+" TL indirim"),$("#kuponFormCnt").addClass("d-none")}else{var n=$("#indirimTutarCnt");n.addClass("d-none"),n.find("#sepetIndirimTutar").html(l(0));var s=$("#kuponOnayCnt");s.addClass("d-none"),s.find("#seciliKuponKodu").html(""),s.find("#kuponIndirimMiktar").html(""),s.find("#kuponIndirimMiktar").html(""),$("#kuponFormCnt").removeClass("d-none")}$(".sepet-sayisi").html(r.sepet_adet),$(".sepetAraToplamTutar").html(l(r.ara_toplam)),$(".sepetKdvToplamTutar").html(l(r.kdv_toplam)),$(".sepetGenelToplamTutar").html(l(r.sepet_toplam)),$(".sepetKargoTutar").html(l(r.kargo_tutar))}},m=()=>{$("input#urun-adet").on("change",function(){let e=Number($(this).val());(isNaN(e)||e<=0)&&(e=1),$(this).val(e)}),$(".btn-increase").on("click",function(){var e=$(this).closest(".wg-quantity").find(".quantity-product"),t=parseInt(e.val())||0;e.val(t+1).trigger("change")}),$(".btn-decrease").on("click",function(){var e=$(this).closest(".wg-quantity").find(".quantity-product"),t=parseInt(e.val())||0;t>1&&e.val(t-1).trigger("change")}),$("#sepet-tablo").on("change",".sepetUrunAdet",function(){var e=$(this).closest("tr"),t=e.attr("sepet-id"),n=$(this).val(),s=parseInt(n,10);(isNaN(s)||s<=0)&&(n.val(1),s=1);var a=e.find(".sepet-toplam-sutun"),o=c.urunler.find(d=>d.sepet_id===parseInt(t));if(o){o.adet=s;var p=(o.adet*o.birim_fiyat).toFixed(2)}return c.sepetiKaydet().then(d=>(d&&a.html(l(p)),d))}),$("#sepet-onizleme-cnt").on("click",".sepetten-cikar-btn",function(){var e=$(this).closest(".pr"),t=e.attr("sepet-id");c.sepettenCikar(t,function(n){n&&e.remove()})}),$(".sepete-ekle-btn").on("click",function(){const e=Number($("#urun-adet").val());if(!e||e<=0){alert("Lütfen geçerli bir adet girin.");return}let t={id:$(this).attr("urun-id"),varyantlar:[]};$(".varyantlar input:checked").each(function(){t.varyantlar.push(Number($(this).val()))}),c.sepeteEkle(t,e)}),$(".favori-ekle-btn").on("click",function(){const e=$(this),t=e.attr("urun-id");axios.post(`${appUrl}/favori/ekle`,{urun_id:t}).then(function(){e.addClass("d-none"),e.siblings(".favori-sil-btn").removeClass("d-none")}).catch(function(n){console.log(n)})}),$(".favori-sil-btn").on("click",function(){const e=$(this),t=e.attr("urun-id"),n=e.closest(".favori-oge");axios.post(`${appUrl}/favori/sil`,{urun_id:t}).then(function(){e.addClass("d-none"),e.siblings(".favori-ekle-btn").removeClass("d-none"),n.remove();var s=$("#favoriTablo");s.find(".favori-oge").length===0&&s.append('<div class="text-center col-12">Favorinizde ürün yok!</div>')}).catch(function(s){console.log(s)})}),$(".sepetten-cikar-btn").on("click",function(){var e=$(this).closest("tr"),t=e.attr("sepet-id");c.sepettenCikar(t,function(n){if(n){e.remove();var s=$(".sepet-tablo");s.find("tr").length===0&&(aktifDil=="tr"?s.append('<tr col-span="5" class="text-center">Sepetinizde ürün yok ! </tr>'):s.append('<tr col-span="5" class="text-center"> There are no items in your cart ! </tr>'))}})}),$("#kupon-btn").on("click",function(){var e=$("#kupon").val();axios.get(`${appUrl}/kupon/kontrol`,{params:{kupon_kod:e}}).then(function(t){u({icon:"success",baslik:t.data.mesaj,onayButonİcerik:"Tamam"}),c.sepetiYukle()}).catch(function(t){u({icon:"error",baslik:t.response.data.mesaj,onayButonİcerik:"Tamam"})})}),$("#kupon-iptal").on("click",function(){axios.get(`${appUrl}/kupon/iptal`).then(function(e){u({icon:"success",baslik:e.data.mesaj,onayButonİcerik:"Tamam"}),c.sepetiYukle()}).catch(function(e){u({icon:"error",baslik:e.response.data.mesaj,onayButonİcerik:"Tamam"})})}),$("#kupon").on("keyup",function(){var e=$(this).val();e.length>0?$("#kupon-btn").removeClass("disabled"):$("#kupon-btn").addClass("disabled")}),$("#urun-filtre-btn").on("click",function(){const e=$("#min-price").val(),t=$("#max-price").val();var n=[];$(".filtre-varyantlar .varyant:checked").each(function(){n.push($(this).attr("varyant-id"))});var s=n.join(","),a=new URL(window.location.href);e?a.searchParams.set("minFiyat",e):a.searchParams.delete("minFiyat"),t?a.searchParams.set("maxFiyat",t):a.searchParams.delete("maxFiyat"),s?a.searchParams.set("varyantlar",s):a.searchParams.delete("varyantlar"),window.location.href=a.toString()}),$("#filtre-sayfa-adet").on("change",function(){var e=new URL(window.location.href);e.searchParams.set("sayfa-adet",$(this).val()),window.location.href=e.toString()}),$(".filtre-select").on("change",function(){var e=new URL(window.location.href),t=$(this).val();t==="ilgili"?e.searchParams.delete("filtre"):e.searchParams.set("filtre",t),window.location.href=e.toString()}),$("form").on("submit",function(e){e.preventDefault()});let r;$("#filtre-arama").on("keyup",function(){document.getElementById("filtre-arama").value.toLowerCase();const e=document.querySelector(".preemptive-search");r&&r.cancel("Previous request was canceled due to new input."),r=axios.CancelToken.source(),axios({method:"get",url:`${appUrl}/urunler/ajax?q=${$(this).val()}&dil=${aktifDil}`,responseType:"json",cancelToken:r.token}).then(function(t){const n=t.data.data||[];e.innerHTML="",console.log(n,n.length),n.length>0?n.forEach(a=>{const o=document.createElement("div");o.className="col-xl-2 col-sm-4 col-6",o.innerHTML=`
                        <div class="product-box-6">
                            <div class="img-wrapper">
                                <div class="product-image">
                                    <a href="${a.slug}">
                                        <img class="bg-img" src="${a.ana_resim}" alt="${a.urun_baslik}">
                                    </a>
                                </div>
                            </div>
                            <div class="product-detail">
                                <div>
                                    <a href="${a.slug}">
                                        <h6>${a.urun_baslik}</h6>
                                    </a>
                                    <p>${a.fiyat} TL</p>
                                </div>
                            </div>
                        </div>
                    `,e.appendChild(o)}):e.innerHTML="<h5>Sonuç bulunamadı.</h5>";const s=document.querySelectorAll(".bg-img");for(i=0;i<s.length;i++){let a=s[i];a.classList.contains("bg-top")?a.parentNode.classList.add("b-top"):a.classList.contains("bg-bottom")?a.parentNode.classList.add("b-bottom"):a.classList.contains("bg-center")?a.parentNode.classList.add("b-center"):a.classList.contains("bg-left")?a.parentNode.classList.add("b-left"):a.classList.contains("bg-right")&&a.parentNode.classList.add("b-right"),a.classList.contains("blur-up")&&a.parentNode.classList.add("blur-up","lazyload"),a.classList.contains("bg_size_content")&&a.parentNode.classList.add("b_size_content"),a.parentNode.classList.add("bg-size");const o=a.src;a.style.display="none",a.parentNode.setAttribute("style",`
                            background-image: url(${o});
                            background-size:cover;
                            background-position: center;
                            background-repeat: no-repeat;
                            display: block;
                        `)}}).catch(function(t){axios.isCancel(t)||console.error("Arama hatası:",t)})}),$("#filtre-arama-btn").on("click",function(){const e=$("#filtre-arama-form").attr("action"),t=$("#filtre-arama").val(),n=new URL(e);n.searchParams.set("q",t),window.location.href=n.toString()}),$(".varyantlar").on("click",".varyant",function(){$(this).closest(".varyantlar").find(".varyant").removeClass("active"),$(this).addClass("active")}),$(".filtre-varyantlar").on("click",".varyant",function(){$(this).toggleClass("active")}),$("#urun-adet").change(function(e){e.preventDefault(),console.log(this.value)})};function v(){c.sepetiYukle()}
