import{a as c}from"./axios-upsvKRUO.js";import{u as f}from"./real-ZMtuIudR.js";import{I as v}from"./form-BX-7WjtY.js";import"./app-DeQrA2Ni.js";const I=(()=>{const{Swall:o,SwallCikis:t,FormKontrol:l}=f(),n=()=>{new Date().getFullYear()%100,[{elementId:"siparisTelefon",maske:"+{90} 000 000 00 00"},{elementId:"siparisPostaKodu",maske:"00000"}].forEach(({elementId:a,maske:e,bloklar:i})=>{const r=i?{mask:e,blocks:i}:{mask:e};v(document.getElementById(a),r)}),$("input[name='payment']").on("change",function(){$(this).val()=="kapida"?($("#siparisKapidaOdemeTutar").removeClass("d-none"),$(".sepetGenelToplamTutar").text(Math.floor(toplamTutar)+Math.floor(kapidaOdemeTutar)+" TL")):($("#siparisKapidaOdemeTutar").addClass("d-none"),$(".sepetGenelToplamTutar").text(Math.floor(toplamTutar)+" TL"))})},p=()=>{const s=new FormData,a={siparisIsim:$("#siparisIsim").val(),siparisTelefon:$("#siparisTelefon").val(),siparisEposta:$("#siparisEposta").val(),siparisIl:$("#siparisIl").val(),siparisIlce:$("#siparisIlce").val(),siparisAdres:$("#siparisAdres").val(),siparisPostaKodu:$("#siparisPostaKodu").val(),siparisOdemeTip:$("input[name='payment']:checked").val()};for(const[e,i]of Object.entries(a))i&&s.append(e,i);return{formVerisi:s}},m=async()=>{if(u()){const s=$("input[name='payment']:checked").val(),{formVerisi:a}=p();o({icon:"info",icerik:"Sipariş Oluşturuluyor, Lütfen Bekleyiniz ...",onayButonDurum:!1});try{const{data:e}=await c.post(appUrl+"/siparis/ekle",a,{headers:{"Content-Type":"multipart/form-data"}});s=="krediKarti"?(console.log(e),$("#siparisForm").remove(),$("#odemeIframeAlani").removeClass("d-none"),$("#iyziIframe").attr("src",e.data.iframeLink+"&iframe=true"),window.addEventListener("message",function(i){var r;((r=i.data)==null?void 0:r.type)==="odemeSonucu"&&i.data.redirectUrl&&setTimeout(()=>{window.location.href=i.data.redirectUrl,$(document).scrollTop(0)},2e3)}),t()):window.location.href=appUrl+"/odeme/basarili"}catch{o({icon:"error",icerik:aktifDil==="tr"?"Lütfen tüm alanları doğru bir şekilde doldurup tekrar deneyiniz!":"Please fill in all fields correctly and try again!",onayButonIcerik:"Tamam"})}}},d=()=>{$("#odeme-btn").on("click",m)},u=()=>{const s="siparisForm";let a={siparisIsim:$("#siparisForm #siparisIsim").val(),siparisTelefon:$("#siparisForm #siparisTelefon").val(),siparisEposta:$("#siparisForm #siparisEposta").val(),siparisIl:$("#siparisForm #siparisIl").val(),siparisIlce:$("#siparisForm #siparisIlce").val(),siparisAdres:$("#siparisForm #siparisAdres").val(),siparisPostaKodu:$("#siparisForm #siparisPostaKodu").val()};const e=[{label:"İsim Soyisim",name:"siparisIsim",value:a.siparisIsim,required:!0},{label:"Telefon",name:"siparisTelefon",value:a.siparisTelefon,required:!0},{label:"E-Posta",name:"siparisEposta",value:a.siparisEposta,required:!0},{label:"İl",name:"siparisIl",value:a.siparisIl,required:!0},{label:"İlçe",name:"siparisIlce",value:a.siparisIlce,required:!0},{label:"Adres",name:"siparisAdres",value:a.siparisAdres,required:!0},{label:"Posta Kod",name:"siparisPostaKodu",value:a.siparisPostaKodu,required:!0}];return l().validate(s,e)};return{init:()=>{n(),d()}}})();document.addEventListener("DOMContentLoaded",I.init);
